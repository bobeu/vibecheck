# Prompt

Feature Integration: Volatility Vanguard Prediction Game

GOAL: Integrate a cUSD-based prediction market using MiniPay and a new smart contract, where users bet on a token's actual 7-day price volatility relative to its VibeCheck Vibrancy Score (AI-implied risk).

1. Smart Contract Development: VolatilityVanguard.sol

You will need to deploy a new smart contract that manages the betting pool, timestamps, and resolution logic.

Function 1: placePrediction(address token, uint8 impliedRiskLevel, bool predictedHigher)

Inputs:

token: The address of the asset being predicted (e.g., cUSD, CELO, etc.).

impliedRiskLevel: The risk level derived from the current VibeCheck score (0=Low, 1=Medium, 2=High).

predictedHigher: true if the user predicts the actual volatility will be HIGHER than expected; false for LOWER.

Requirements: Must receive 0.1 cUSD payment (via MiniPay) from msg.sender.

Action: Record the current price of the token (via Oracle), the timestamp, the impliedRiskLevel, and the user's prediction.

Function 2: resolvePrediction(uint256 predictionId)

Requirements: Must only be called after the 7-day prediction period has elapsed.

Action:

Fetch the final price of the token (via Oracle).

Calculate Actual Volatility (Absolute change over 7 days).

Determine the Expected Volatility Threshold based on impliedRiskLevel:

0 (Low): Threshold is 5%

1 (Medium): Threshold is 15%

2 (High): Threshold is 15% (Used only for High prediction to determine if the market was less volatile than expected).

Determine the winning condition (Higher/Lower) based on where the Actual Volatility falls relative to the Threshold.

Distribute the collected cUSD pool amongst all addresses that made the correct prediction.

2. Frontend (HTML/JS) Integration Steps

You must create a dedicated section below the VibeCheck report to manage the game.

UI Component: Add a new, prominent "Volatility Vanguard" card or section below the main VibeCheck results.

Risk Calculation Logic: Implement the following client-side JavaScript function to map the AI score to a contract input:

```
/**
 * Maps the VibeCheck score to a simplified risk level for the contract.
 * @param {number} score - The VibeCheck Vibrancy Score (0-100).
 * @returns {number} 0 (Low), 1 (Medium), or 2 (High).
 */
function mapScoreToImpliedRisk(score) {
    if (score >= 80) return 0; // Low Risk (Max 5% expected change)
    if (score >= 50) return 1; // Medium Risk (Max 15% expected change)
    return 2; // High Risk (> 15% expected change)
}
```

Display Current Odds: Display the current betting pool size and the percentage of users betting on Higher vs. Lower volatility (fetchable from a new contract function).

Transaction Handling:

On button click, call mapScoreToImpliedRisk using the token's current Vibrancy Score.

Execute the placePrediction contract function using MiniPay for the 0.1 cUSD transaction.

Show a confirmation modal displaying the prediction ID and the 7-day resolution time.

Tracking and Resolution UI: Users must have a section to track their Pending Predictions. After 7 days, they should see a "Resolve" button which triggers the resolvePrediction contract function for their specific prediction ID.

